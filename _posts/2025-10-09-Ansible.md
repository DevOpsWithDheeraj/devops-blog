
---

🧩 1. What is Ansible?

Ansible is an open-source automation tool used for:

Configuration management

Application deployment

Infrastructure provisioning

Continuous delivery (CI/CD) integration


✅ Agentless — works over SSH
✅ Idempotent — running same playbook multiple times gives same result
✅ Written in YAML (simple syntax)


---

🧱 2. Key Components of Ansible

Component	Description

Inventory	List of servers/hosts to manage (/etc/ansible/hosts or custom file)
Module	Reusable scripts Ansible runs on nodes (e.g., yum, copy, service)
Task	A single action executed using a module
Playbook	YAML file describing automation tasks
Role	A structured collection of playbooks, templates, and files
Facts	System info collected automatically by Ansible
Handlers	Triggered only when notified (used for service restarts, etc.)



---

⚙️ 3. Installation & Setup

On Control Node (Linux)

sudo yum install ansible -y          # RHEL/CentOS
sudo apt install ansible -y          # Ubuntu/Debian
ansible --version

Create Inventory File

/etc/ansible/hosts

[webservers]
192.168.1.10
192.168.1.11

[dbservers]
192.168.1.20

Test Connectivity

ansible all -m ping


---

📘 4. Ansible Ad-hoc Commands

Quickly execute commands without a playbook.

ansible all -a "uptime"             # Run uptime command
ansible webservers -m yum -a "name=httpd state=present"   # Install package
ansible dbservers -m service -a "name=mariadb state=started enabled=yes"
ansible all -m copy -a "src=/tmp/test.txt dest=/tmp/"


---

📜 5. Writing Your First Playbook

install_apache.yml

---
- name: Install and Start Apache Web Server
  hosts: webservers
  become: yes

  tasks:
    - name: Install Apache
      yum:
        name: httpd
        state: present

    - name: Start and enable service
      service:
        name: httpd
        state: started
        enabled: yes

Run:

ansible-playbook install_apache.yml


---

🧩 6. Variables and Templates

Define Variables:

vars:
  pkg: httpd
  port: 80

Using Jinja2 Template:

index.html.j2

<h1>Welcome to {{ ansible_hostname }}</h1>

Task:

- name: Deploy Webpage
  template:
    src: index.html.j2
    dest: /var/www/html/index.html


---

🔁 7. Conditionals, Loops, and Handlers

Conditionals

- name: Install Apache only on RHEL
  yum:
    name: httpd
    state: present
  when: ansible_os_family == "RedHat"

Loops

- name: Install multiple packages
  yum:
    name: "{{ item }}"
    state: present
  loop:
    - git
    - wget
    - curl

Handlers

handlers:
  - name: restart apache
    service:
      name: httpd
      state: restarted

tasks:
  - name: Copy config file
    copy:
      src: httpd.conf
      dest: /etc/httpd/conf/httpd.conf
    notify: restart apache


---

🧱 8. Roles – Reusable Structure

Create a role:

ansible-galaxy init webserver

Folder structure:

webserver/
├── tasks/main.yml
├── templates/
├── files/
├── vars/main.yml
├── handlers/main.yml

Use in Playbook:

- hosts: webservers
  roles:
    - webserver


---

☁️ 9. Ansible with Cloud (AWS Example)

Install AWS module dependencies:

pip install boto boto3

Example – Create EC2 instance:

- name: Create EC2 Instance
  hosts: localhost
  connection: local
  tasks:
    - name: Launch EC2
      ec2:
        key_name: mykey
        instance_type: t2.micro
        image: ami-123456
        wait: yes
        count: 1
        region: ap-south-1


---

🔄 10. Ansible + Jenkins (CI/CD Integration)

Jenkins pulls code from GitHub.

Jenkins triggers Ansible playbook for deployment.
Example build step:


ansible-playbook -i inventory deploy.yml


---

🧠 11. Real-World Example: 3-Tier App Deployment

Goal: Deploy Web, App, and DB tiers.

Web Tier: Install Nginx and host frontend

App Tier: Deploy Python app

DB Tier: Setup MySQL


Each tier = separate role (web, app, db).
Single playbook orchestrates all roles sequentially.


---

🛠️ 12. Best Practices

✅ Use roles for modularity
✅ Use variables for reusability
✅ Encrypt secrets with Ansible Vault
✅ Version control playbooks in Git
✅ Use dynamic inventory for cloud resources
✅ Run --check mode for dry runs before production


---

🔐 13. Ansible Vault (Encrypt Secrets)

ansible-vault create secrets.yml
ansible-vault view secrets.yml
ansible-vault edit secrets.yml
ansible-playbook site.yml --ask-vault-pass


---

🧩 14. Ansible Advanced Topics

Dynamic Inventories (AWS, Azure, GCP)

Ansible Tower / AWX for GUI-based automation

Writing custom modules (Python)

Using ansible-pull for agent-based model

Managing large environments with tags and includes



---

🚀 15. Real DevOps Use Cases

Automate EC2 provisioning and configuration

Continuous deployment of Docker containers

Patch management across 100+ Linux servers

CI/CD integration with Jenkins pipelines

Kubernetes cluster node setup using Ansible



---
